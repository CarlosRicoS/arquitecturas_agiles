# Enable OAuth2 authentication
auth_backends.1 = rabbitmq_auth_backend_oauth2

# OAuth2 configuration
auth_oauth2.resource_server_id = inventario-test
auth_oauth2.resource_server_type = jwt  # Must be 'jwt' for JWT authentication
auth_oauth2.default_key = inventario-test-key  # This should match the key identifier in the JWKS endpoint

# Define the signing algorithm
auth_oauth2.algorithms.1 = HS256  # Valid algorithms: rs256, rs384, rs512, hs256, etc.

# Set the JWT claim to be used as the username in RabbitMQ
auth_oauth2.preferred_username_claims.1 = sub  # 'sub' is standard, but you can change it if needed

# Load definitions from a JSON file
load_definitions = /etc/rabbitmq/definitions.json
